version: '3.3'

services:
  nginx:
    container_name: 'nginx'
    image: 'nginx'
    ports:
      - "81:80"
    volumes:
      - ./nginx/nginx.conf:/etc/nginx/nginx.conf
      - ./nginx/logs/:/var/log/nginx
      - ./nginx/ssl-keys:/etc/nginx/ssl
      # - ./nginx/sites-available:/etc/nginx/sites-enabled
    depends_on:
      - couchdb

  couchdb:
    container_name: 'couchdb'
    image: 'couchdb:2.2'
    networks:
      - medic-net
    ports:
      - "5985:5984"
      # - "4370:4369"
      # - "9101:9100"
    environment:
      - COUCHDB_USER=admin
      - COUCHDB_PASSWORD=pass
      - NODENAME=127.0.0.1
    volumes:
      - couchdb-data:/opt/couchdb/data
      - ./couchdb/local.ini:/opt/couchdb/etc/local.ini
      - ./couchdb/logs:/var/logs/couchdb

volumes:
  couchdb-data:

networks:
  medic-net: